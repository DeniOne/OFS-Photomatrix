# Памятка для разработки функциональности "Должности"

## Текущий контекст проекта
- Мы реализуем ERP-систему ОФС Фотоматрица
- Бэкенд: FastAPI + PostgreSQL + SQLAlchemy 2.0 (асинхронный)
- Фронтенд: React + TypeScript + Vite + Mantine UI

## Уже реализовано
1. ✅ Бэкенд модели и API для Organization, Division, Section, Function
2. ✅ Фронтенд страницы для управления Organizations, Functions
3. ✅ Типы и API-клиенты для основных сущностей

## Нужно реализовать для должностей (Positions)
1. Проверить модель Position и API на бэкенде
2. Создать типы для Position на фронтенде
3. Разработать API-клиент для Position (positionApi.ts)
4. Создать компоненты:
   - PositionsPage - страница со списком должностей
   - PositionsTable - таблица для отображения должностей
   - PositionForm - форма для создания/редактирования должностей
5. Добавить навигацию к странице должностей

## Иерархия сущностей
```
Organization → Division → Section → Position
```

## Особенности реализации
- Должности привязываются к отделам (Section)
- В форме должна быть возможность выбора отдела
- Должна быть реализована фильтрация по отделам

## Важные файлы для примера
- frontend/src/features/functions/pages/FunctionsPage.tsx - пример страницы
- frontend/src/features/sections/api/sectionApi.ts - пример API-клиента
- frontend/src/types/function.ts - пример типов

## Решенные в прошлом проблемы
- Асинхронные функции на бэкенде должны использовать `async/await`
- API-клиент должен правильно обрабатывать фильтры
- При использовании хуков типа `usePositions(null)` проверить, что нет ограничений с `enabled: !!param`

## Статус работы над функциями (для справки)
- ✅ Создана страница управления функциями (FunctionsPage) с CRUD-операциями
- ✅ Исправлена ошибка с асинхронными функциями в API для функций - добавлены async/await для всех эндпоинтов
- ✅ Исправлен UI страницы функций - убрано дублирование заголовка и перемещена кнопка добавления
- ✅ Исправлена проблема с загрузкой отделов в форме функций - убрано ограничение `enabled: !!divisionId` в API 